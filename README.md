# Django Start Урок №15 CRUD.


В цьому завданні ми зробимо примітивну домашню сторінку з посиланнями і списком аніме.

## Для початку давай створимо віртуальну машину або ж іншими словами `venv`. Для цього пропиши наступні команди

# Windows
```python
python -m venv venv
venv/Scripts/Activate.ps1
```

# Linux or MAC
```python
python3 -m venv venv
source venv/bin/activate
```

Після чого тобі потрібно встановити всі заледності тому в консоль пишемо `pip install -r requirements.txt`.

Створимо бд:
1) Введи команду для онволення бд `python manage.py makemigrations`
1) Введи команду для створення бд `python manage.py migrate`

# =====Оновлення бази данних====
До моделі `Anime` додаємо наступні поля:
* `real_rating` - поля для обрахунку `models.PositiveIntegerField(null=True, blank=True)`
* `url` - Тут зберігаємо посилання на аніме `models.URLField(null=True, blank=True)`
* `is_watched` - Булеве поле з значенням `default=False`
* `watched_date` - Тут бедемо зврігати дату завершення перегляду `models.DateField(null=True, blank=True)`

# =====Create view====

Результат має бути таким
![Alt text](<result_img/Create page.png>)
Для початку створимо view `index`. Вона точно такаж як і на уроці але тут ми звісно, показуємо к-ть аніме і їх типів.

Тепер значення `__all__` нам не підходить і поля при створенні ми пропишемо власноруч!

Список полів при створенні:
* `name`
* `description`
* `episodes`
* `type`
* `url`

Також навчимося робити спец обрахунки при створенні як на уроці ( дивіться в код з уроку на платформі, так буде простіше )

При створенні перевіряємо, якщо `type.name =="Fantasy"` в значення `real_rating` записуємо `100` якщо ні то `None`!
Підсказка: для цього треба скористатись методом
```python
def form_valid(self, form):
    # Ваш код для цього тут

    return super().form_valid(form)
```

# =====Update view====
Таким повинен бути результат
![Alt text](<result_img/Update page.png>)

Тут також оновлюємо не всі поля, а назви цих полів ви можете побачити на скріні  вище.

# =====Detail view====
Якщо аніме має посилання сторінка повинна бути такою:
![Alt text](<result_img/Detail page with link.png>)
Якщо ссилки на перегляд немає то такою відповідно:
![Alt text](<result_img/Detail page no link.png>)

Також додайте рядок `If Fantasy`, але показуйте його лише тоді коли значення `real_rating` == 100 або коли воно не дорівнює значенню `None` це вже на ваш
смак. Приклад не найкращий але не придумав, щось толкове для прикладу, проте робити такі обрахунки треба вміти.

# =====List view====
Результат має бути таким
![Alt text](<result_img/List page.png>)

Для досягнення результату робимо наступне

# Додаємо status 
Це кнопочка яка є синьою при натисканні на неї ми позначаємо аніме як переглянуте, якщо вона вже натиснута, тобно аніме позначенно як преглянуте, - то
вона має  бути зеленого кольору і з значенням `disabled`.

Для цієї задачі звісно робимо функціональну вю `def mark_item_as_watched(request, pk)` вона повинна міняти значення `is_watched` на `True` і в поле
`watched_date` проставляти теперішню дату (Підсказка: абсолютно таку ж ми робили на уроці!)

# Додаємо delete
Тут робимо вю  `def delete_anime(request, pk)` де ми просто видаляємо аніме з списка

# Додаємо загальну к-ть аніме в списку
Підсказка: Для цього використай метод 
```python
def get_context_data(self, *args, **kwargs) -> dict:
    context = super().get_context_data(**kwargs)
    
    # Ваш код для цього пишемо тут (один рядок має бути)
    
    return context
```

Після заверщення пишемо в консоль `python manage.py test` і дивимось чи пройшли ми всі тести.
